{% block _service_point_facility_businessHours_row %}
    <div class="control-group">
        <div class="control-label wrap">
            {{ form_label(form) }}
        </div>
    </div>
    <div class="control-group control-group-collection">
        {{ form_widget(form) }}
    </div>
{% endblock %}

{% block _service_point_facility_businessHours_widget %}
    {% import _self as formFields %}
    {% if prototype is defined %}
        {% set prototype_html = formFields.timeperiod_item_prototype(form) %}
    {% endif %}
    {% set attr = attr|merge({'class': (attr.class is defined ? attr.class ~ ' ' : '') ~ 'oro-item-collection collection-fields-list' }) %}
    {% set id = id ~ '_collection' %}
    {% set prototype_name = form.vars.prototype_name %}
    <div class="row-oro">
        <input type="hidden" name="validate_{{ full_name }}" data-collection-name="{{ full_name }}" data-name="collection-validation" disabled data-validate-element>
        <table>
            <thead>
                <tr>
                    <th>{{ 'marello.servicepoint.timeperiod.day_of_week.label'|trans }}</th>
                    <th>{{ 'marello.servicepoint.timeperiod.open_time.label'|trans }}</th>
                    <th>{{ 'marello.servicepoint.timeperiod.close_time.label'|trans }}</th>
                    <th></th>
                </tr>
            </thead>
            <tbody {{ block('widget_container_attributes') }} data-last-index="{{ form.children|length}}" data-row-count-add="{{ form.vars.row_count_add }}" data-prototype-name="{{ prototype_name }}"{% if prototype_html is defined %} data-prototype="{{ prototype_html|escape }}"{% endif %}>
            {% if form.children|length %}
                {% for child in form.children %}
                    {{ formFields.timeperiod_item_prototype(child) }}
                {% endfor %}
            {% elseif show_form_when_empty and prototype_html is defined %}
                {% for i in 0..(form.vars.row_count_initial - 1) %}
                    {{ prototype_html|replace({(prototype_name): i})|raw }}
                {% endfor %}
            {% endif %}
            </tbody>
        </table>
    {% if allow_add %}
        <a class="btn add-list-item" data-container=".oro-item-collection" href="#" role="button">{{ form.vars.add_label|default('oro.form.collection.add')|trans }}</a>
    {% endif %}
    </div>
{% endblock %}

{% block time_period_widget %}
    {% set attr = layout_attr_defaults(attr, {'~class': '.oro-multiselect-holder'}) %}
    <td>{{ form_widget(form.dayOfWeek) }}</td>
    <td>{{ form_widget(form.openTime) }}</td>
    <td>{{ form_widget(form.closeTime) }}</td>
    <td>
        <button class="removeRow btn btn-icon btn-square-light"
                aria-label="{{ 'oro.form.collection.remove'|trans }}"
                type="button"
                data-related="{{ name }}">
        </button>
    </td>
{% endblock %}

{% block _service_point_facility_businessHours_entry_dayOfWeek_widget %}
    <div class="oro-row oro-multiselect-holder">
        {{ form_widget(form) }}
    </div>
{% endblock %}

{% block _service_point_facility_businessHours_entry_openTime_widget %}
    <div class="oro-row oro-multiselect-holder">
        {{ form_widget(form) }}
    </div>
{% endblock %}

{% block _service_point_facility_businessHours_entry_closeTime_widget %}
    <div class="oro-row oro-multiselect-holder">
        {{ form_widget(form) }}
    </div>
{% endblock %}

{% macro timeperiod_item_prototype(widget) %}
    {% if 'collection' in widget.vars.block_prefixes %}
        {% set form = widget.vars.prototype %}
        {% set name = widget.vars.prototype.vars.name %}
    {% else %}
        {% set form = widget %}
        {% set name = widget.vars.full_name %}
    {% endif %}
    <tr class="oro-collection-item"
        data-content="{{ name }}"
    {% if widget.parent.vars.skip_optional_validation_group is not defined %}
        data-validation-optional-group
        {% if form.vars.attr['data-validation-optional-group-handler'] is defined %}
        data-validation-optional-group-handler="{{ form.vars.attr['data-validation-optional-group-handler'] }}"
        {% endif %}
    {% endif %}
    >
        {{ form_widget(form) }}
    </tr>
{% endmacro %}
